{% extends "base.html" %}

{% block content %}
{% if user.is_authenticated %}
<div class="container my-5">
    <div class="row g-4">
        <!-- Loop through the products added to the cart -->
        {% for item in productitem %}
        <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0.5 rounded-4 overflow-hidden d-flex flex-column">

                <!-- Product Image -->
                <div class="position-relative">
                    {% with item.product.images.first as img %}
                    {% if img.image_url %}
                        <img src="{{ img.image_url }}"
                             class="card-img-top img-fluid"
                             alt="{{ item.product.product_name }}"
                             style="height: 260px; object-fit: contain; background-color: #f9f9f9; padding: 10px;">
                    {% elif img.image %}
                        <img src="{{ img.image.url }}"
                             class="card-img-top img-fluid"
                             alt="{{ item.product.product_name }}"
                             style="height: 260px; object-fit: contain; background-color: #f9f9f9; padding: 10px;">
                    {% endif %}
                {% endwith %}
                

                    <!-- Price Tag -->
                    <span class="badge bg-success position-absolute top-0 end-0 m-2 px-3 py-2 fs-6 rounded-pill">
                        Rs {{ item.product.product_price }}
                    </span>
                </div>

                <!-- Product Info -->
                <div class="card-body d-flex flex-column justify-content-between">
                    <h5 class="card-title text-center fw-semibold text-dark mb-3" style="font-size: 1.1rem;">
                        {{ item.product.product_name }}
                    </h5>

                    <!-- Buy Button -->
                    <a href="/order/{{ item.product.product_slug }}"
                       class="btn btn-primary w-100 mt-auto">
                        Buy Now
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% else %}
<script type="text/javascript">
    window.location.href = "{% url 'login' %}";
</script>
{% endif %}
{% endblock content %}
